<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Nearest Neighbors | Turi Machine Learning Platform User Guide</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.4">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-anchors/plugin.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="../text/intro.html" />
    
    
    <link rel="prev" href="../clustering/dbscan.html" />
    

        <script type="text/javascript" src="../turi/js/d3/d3.min.js"></script><script type="text/javascript" src="../turi/js/jquery/jquery-2.1.3.min.js"></script><script type="text/javascript" src="../supervised-learning/images/random-utils.js"></script><script type="text/javascript" src="../supervised-learning/images/plotting-utils.js"></script><script type="text/javascript" src="../turi/js/metrics.js"></script><link rel="stylesheet" type="text/css" href="../turi/css/glc.css">
    </head>
    <body>
        
        
    <div class="book"
        data-level="3.6"
        data-chapter-title="Nearest Neighbors"
        data-filepath="nearest_neighbors/nearest_neighbors.md"
        data-basepath=".."
        data-revision="Fri Jul 29 2016 19:24:46 GMT+0000 (UTC)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
                
                <li>
                    <a href="https://turi.com" target="blank" class="custom-link">turi.com</a>
                </li>
            
            

            
            <li class="divider"></li>
            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="install.html">
            
                
                    <a href="../install.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Getting started
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="sframe/introduction.html">
            
                
                    <a href="../sframe/introduction.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Working with data
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="sframe/tabular-data.html">
            
                
                    <a href="../sframe/tabular-data.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Tabular data
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="sframe/sframe-intro.html">
            
                
                    <a href="../sframe/sframe-intro.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.1.</b>
                        
                        Loading and Saving
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="sframe/data-manipulation.html">
            
                
                    <a href="../sframe/data-manipulation.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.2.</b>
                        
                        Data Manipulation
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="data_formats_and_sources/spark_integration.html">
            
                
                    <a href="../data_formats_and_sources/spark_integration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.3.</b>
                        
                        Spark RDDs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.1.4" data-path="data_formats_and_sources/sql_integration.html">
            
                
                    <a href="../data_formats_and_sources/sql_integration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.4.</b>
                        
                        SQL Databases
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="sgraph/sgraph.html">
            
                
                    <a href="../sgraph/sgraph.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Graph data
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="timeseries/timeseries-data.html">
            
                
                    <a href="../timeseries/timeseries-data.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        Time series data
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="vis/visualization.html">
            
                
                    <a href="../vis/visualization.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        Visualization
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="feature-engineering/introduction.html">
            
                
                    <a href="../feature-engineering/introduction.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                        Feature Engineering
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.5.1" data-path="feature-engineering/numeric_features.html">
            
                
                    <a href="../feature-engineering/numeric_features.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.1.</b>
                        
                        Numeric Features
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.5.1.1" data-path="feature-engineering/quadratic_features.html">
            
                
                    <a href="../feature-engineering/quadratic_features.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.1.1.</b>
                        
                        Quadratic Features
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5.1.2" data-path="feature-engineering/feature_binner.html">
            
                
                    <a href="../feature-engineering/feature_binner.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.1.2.</b>
                        
                        Feature Binning
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5.1.3" data-path="feature-engineering/numeric_imputer.html">
            
                
                    <a href="../feature-engineering/numeric_imputer.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.1.3.</b>
                        
                        Numeric Imputer
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.5.2" data-path="feature-engineering/categorical_features.html">
            
                
                    <a href="../feature-engineering/categorical_features.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.2.</b>
                        
                        Categorical Features
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.5.2.1" data-path="feature-engineering/one_hot_encoder.html">
            
                
                    <a href="../feature-engineering/one_hot_encoder.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.2.1.</b>
                        
                        One Hot Encoder
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5.2.2" data-path="feature-engineering/count_thresholder.html">
            
                
                    <a href="../feature-engineering/count_thresholder.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.2.2.</b>
                        
                        Count Thresholder
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5.2.3" data-path="feature-engineering/categorical_imputer.html">
            
                
                    <a href="../feature-engineering/categorical_imputer.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.2.3.</b>
                        
                        Categorical Imputer
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5.2.4" data-path="feature-engineering/count_featurizer.html">
            
                
                    <a href="../feature-engineering/count_featurizer.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.2.4.</b>
                        
                        Count Featurizer
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.5.3" data-path="feature-engineering/text_features.html">
            
                
                    <a href="../feature-engineering/text_features.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.3.</b>
                        
                        Text Features
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.5.3.1" data-path="feature-engineering/tfidf.html">
            
                
                    <a href="../feature-engineering/tfidf.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.3.1.</b>
                        
                        TF-IDF
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5.3.2" data-path="feature-engineering/tokenizer.html">
            
                
                    <a href="../feature-engineering/tokenizer.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.3.2.</b>
                        
                        Tokenizer
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5.3.3" data-path="feature-engineering/rare_word_trimmer.html">
            
                
                    <a href="../feature-engineering/rare_word_trimmer.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.3.3.</b>
                        
                        RareWordTrimmer
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5.3.4" data-path="feature-engineering/bm25.html">
            
                
                    <a href="../feature-engineering/bm25.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.3.4.</b>
                        
                        BM25
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5.3.5" data-path="feature-engineering/pos_extractor.html">
            
                
                    <a href="../feature-engineering/pos_extractor.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.3.5.</b>
                        
                        PartOfSpeechExtractor
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5.3.6" data-path="feature-engineering/sentence_splitter.html">
            
                
                    <a href="../feature-engineering/sentence_splitter.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.3.6.</b>
                        
                        SentenceSplitter
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.5.4" data-path="feature-engineering/image_features.html">
            
                
                    <a href="../feature-engineering/image_features.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.4.</b>
                        
                        Image Features
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.5.4.1" data-path="feature-engineering/deep_feature_extractor.html">
            
                
                    <a href="../feature-engineering/deep_feature_extractor.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.4.1.</b>
                        
                        Deep Feature Extractor
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.5.5" data-path="feature-engineering/other_transformations.html">
            
                
                    <a href="../feature-engineering/other_transformations.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.5.</b>
                        
                        Other Transformations
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.5.5.1" data-path="feature-engineering/feature_hasher.html">
            
                
                    <a href="../feature-engineering/feature_hasher.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.5.1.</b>
                        
                        Hasher
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5.5.2" data-path="feature-engineering/random_projection.html">
            
                
                    <a href="../feature-engineering/random_projection.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.5.2.</b>
                        
                        Random Projection
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5.5.3" data-path="feature-engineering/transformer_chain.html">
            
                
                    <a href="../feature-engineering/transformer_chain.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.5.3.</b>
                        
                        Transformer Chain
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5.5.4" data-path="feature-engineering/custom_transformer.html">
            
                
                    <a href="../feature-engineering/custom_transformer.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.5.4.</b>
                        
                        Custom Transformer
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="modeling-data/intro.html">
            
                
                    <a href="../modeling-data/intro.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Modeling data
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="supervised-learning/classifier.html">
            
                
                    <a href="../supervised-learning/classifier.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Classification
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="supervised-learning/logistic-regression.html">
            
                
                    <a href="../supervised-learning/logistic-regression.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.1.</b>
                        
                        Logistic Regression
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="supervised-learning/knn_classifier.html">
            
                
                    <a href="../supervised-learning/knn_classifier.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.2.</b>
                        
                        Nearest Neighbor Classifier
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.1.3" data-path="supervised-learning/svm.html">
            
                
                    <a href="../supervised-learning/svm.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.3.</b>
                        
                        SVM
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.1.4" data-path="supervised-learning/decision_tree_classifier.html">
            
                
                    <a href="../supervised-learning/decision_tree_classifier.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.4.</b>
                        
                        Decision Tree Classifier
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.1.5" data-path="supervised-learning/random_forest_classifier.html">
            
                
                    <a href="../supervised-learning/random_forest_classifier.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.5.</b>
                        
                        Random Forest Classifier
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.1.6" data-path="supervised-learning/boosted_trees_classifier.html">
            
                
                    <a href="../supervised-learning/boosted_trees_classifier.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.6.</b>
                        
                        Boosted Trees Classifier
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.1.7" data-path="supervised-learning/neuralnet-classifier.html">
            
                
                    <a href="../supervised-learning/neuralnet-classifier.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.7.</b>
                        
                        Neuralnet Classifier
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="supervised-learning/regression.html">
            
                
                    <a href="../supervised-learning/regression.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Regression
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.1" data-path="supervised-learning/linear-regression.html">
            
                
                    <a href="../supervised-learning/linear-regression.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.1.</b>
                        
                        Linear Regression
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2.2" data-path="supervised-learning/decision_tree_regression.html">
            
                
                    <a href="../supervised-learning/decision_tree_regression.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.2.</b>
                        
                        Decision Tree Regression
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2.3" data-path="supervised-learning/boosted_trees_regression.html">
            
                
                    <a href="../supervised-learning/boosted_trees_regression.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.3.</b>
                        
                        Boosted Trees Regression
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2.4" data-path="supervised-learning/random_forest_regression.html">
            
                
                    <a href="../supervised-learning/random_forest_regression.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.4.</b>
                        
                        Random Forest Regression
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="supervised-learning/advanced_deeplearning_mxnet.html">
            
                
                    <a href="../supervised-learning/advanced_deeplearning_mxnet.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        Advanced Deep Learning with MXNet
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="graph_analytics/intro.html">
            
                
                    <a href="../graph_analytics/intro.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        Graph analytics
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.4.1" data-path="graph_analytics/graph_analytics.html">
            
                
                    <a href="../graph_analytics/graph_analytics.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.1.</b>
                        
                        Examples
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="clustering/intro.html">
            
                
                    <a href="../clustering/intro.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        Clustering
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.5.1" data-path="clustering/kmeans.html">
            
                
                    <a href="../clustering/kmeans.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.1.</b>
                        
                        KMeans
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5.2" data-path="clustering/dbscan.html">
            
                
                    <a href="../clustering/dbscan.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.2.</b>
                        
                        DBSCAN
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="3.6" data-path="nearest_neighbors/nearest_neighbors.html">
            
                
                    <a href="../nearest_neighbors/nearest_neighbors.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.</b>
                        
                        Nearest Neighbors
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="text/intro.html">
            
                
                    <a href="../text/intro.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.7.</b>
                        
                        Text analysis
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.7.1" data-path="text/analysis.html">
            
                
                    <a href="../text/analysis.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.7.1.</b>
                        
                        Processing text
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.7.2" data-path="text/topic-models.html">
            
                
                    <a href="../text/topic-models.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.7.2.</b>
                        
                        Topic models
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.8" data-path="evaluation/introduction.html">
            
                
                    <a href="../evaluation/introduction.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.8.</b>
                        
                        Evaluating Models
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.8.1" data-path="evaluation/regression.html">
            
                
                    <a href="../evaluation/regression.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.8.1.</b>
                        
                        Regression Metrics
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.8.2" data-path="evaluation/classification.html">
            
                
                    <a href="../evaluation/classification.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.8.2.</b>
                        
                        Classification Metrics
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.9" data-path="model_parameter_search/introduction.html">
            
                
                    <a href="../model_parameter_search/introduction.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.9.</b>
                        
                        Model parameter search
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.9.1" data-path="model_parameter_search/models.html">
            
                
                    <a href="../model_parameter_search/models.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.9.1.</b>
                        
                        Models
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.9.2" data-path="model_parameter_search/search.html">
            
                
                    <a href="../model_parameter_search/search.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.9.2.</b>
                        
                        Choosing a search space
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.9.3" data-path="model_parameter_search/evaluation.html">
            
                
                    <a href="../model_parameter_search/evaluation.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.9.3.</b>
                        
                        Evaluation functions
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.9.4" data-path="model_parameter_search/distributing.html">
            
                
                    <a href="../model_parameter_search/distributing.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.9.4.</b>
                        
                        Distributed execution
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="applications/intro.html">
            
                
                    <a href="../applications/intro.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Applications
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="recommender/introduction.html">
            
                
                    <a href="../recommender/introduction.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        Recommender systems
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="recommender/using-trained-models.html">
            
                
                    <a href="../recommender/using-trained-models.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.1.</b>
                        
                        Using trained models
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="recommender/choosing-a-model.html">
            
                
                    <a href="../recommender/choosing-a-model.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.2.</b>
                        
                        Choosing a model
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="data_matching/introduction.html">
            
                
                    <a href="../data_matching/introduction.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        Data matching
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.1" data-path="data_matching/record_linker.html">
            
                
                    <a href="../data_matching/record_linker.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.1.</b>
                        
                        Record Linker
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2.2" data-path="data_matching/deduplication.html">
            
                
                    <a href="../data_matching/deduplication.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.2.</b>
                        
                        Deduplication
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2.3" data-path="data_matching/autotagger.html">
            
                
                    <a href="../data_matching/autotagger.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.3.</b>
                        
                        Autotagger
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2.4" data-path="data_matching/similarity_search.html">
            
                
                    <a href="../data_matching/similarity_search.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.4.</b>
                        
                        Similarity Search
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="lead_scoring/lead_scoring.html">
            
                
                    <a href="../lead_scoring/lead_scoring.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                        Lead Scoring
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="churn_prediction/quick-start.html">
            
                
                    <a href="../churn_prediction/quick-start.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                        Churn prediction
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.4.1" data-path="churn_prediction/using-a-trained-model.html">
            
                
                    <a href="../churn_prediction/using-a-trained-model.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.1.</b>
                        
                        Using a trained model
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.4.2" data-path="churn_prediction/alternate-input-formats.html">
            
                
                    <a href="../churn_prediction/alternate-input-formats.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.2.</b>
                        
                        Alternate input formats
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.4.3" data-path="churn_prediction/how-it-works.html">
            
                
                    <a href="../churn_prediction/how-it-works.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.3.</b>
                        
                        How it works
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="pattern_mining/frequent-pattern-mining.html">
            
                
                    <a href="../pattern_mining/frequent-pattern-mining.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                        Frequent Pattern Mining
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="sentiment_analysis/introduction.html">
            
                
                    <a href="../sentiment_analysis/introduction.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.6.</b>
                        
                        Sentiment analysis
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.6.1" data-path="sentiment_analysis/sentiment-analysis.html">
            
                
                    <a href="../sentiment_analysis/sentiment-analysis.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.6.1.</b>
                        
                        Applying a sentiment classifier
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.6.2" data-path="sentiment_analysis/product-sentiment.html">
            
                
                    <a href="../sentiment_analysis/product-sentiment.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.6.2.</b>
                        
                        Product sentiment analysis and review data
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.7" data-path="anomaly_detection/intro.html">
            
                
                    <a href="../anomaly_detection/intro.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.7.</b>
                        
                        Anomaly Detection
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.7.1" data-path="anomaly_detection/local_outlier_factor.html">
            
                
                    <a href="../anomaly_detection/local_outlier_factor.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.7.1.</b>
                        
                        Local Outlier Factor
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.7.2" data-path="anomaly_detection/moving_zscore.html">
            
                
                    <a href="../anomaly_detection/moving_zscore.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.7.2.</b>
                        
                        Moving Z-Score
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.7.3" data-path="anomaly_detection/bayesian_changepoints.html">
            
                
                    <a href="../anomaly_detection/bayesian_changepoints.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.7.3.</b>
                        
                        Bayesian Changepoints
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="deployment/pipeline-introduction.html">
            
                
                    <a href="../deployment/pipeline-introduction.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Turi Distributed
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="deployment/pipeline-launch.html">
            
                
                    <a href="../deployment/pipeline-launch.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        Asynchronous Jobs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="deployment/pipeline-hadoop-setup.html">
            
                
                    <a href="../deployment/pipeline-hadoop-setup.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        Installing on Hadoop
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="deployment/pipeline-ec2-hadoop.html">
            
                
                    <a href="../deployment/pipeline-ec2-hadoop.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                        Clusters
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="deployment/pipeline-example.html">
            
                
                    <a href="../deployment/pipeline-example.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.4.</b>
                        
                        End-to-End Example
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.5" data-path="deployment/pipeline-distributed.html">
            
                
                    <a href="../deployment/pipeline-distributed.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.5.</b>
                        
                        Distributed Job Execution
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.6" data-path="deployment/pipeline-dml.html">
            
                
                    <a href="../deployment/pipeline-dml.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.6.</b>
                        
                        Distributed Machine Learning
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.7" data-path="deployment/pipeline-monitoring-jobs.html">
            
                
                    <a href="../deployment/pipeline-monitoring-jobs.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.7.</b>
                        
                        Monitoring Jobs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.8" data-path="deployment/pipeline-keeping-track-of-jobs-tasks-and-environments.html">
            
                
                    <a href="../deployment/pipeline-keeping-track-of-jobs-tasks-and-environments.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.8.</b>
                        
                        Session Management
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.9" data-path="deployment/pipeline-dependencies.html">
            
                
                    <a href="../deployment/pipeline-dependencies.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.9.</b>
                        
                        Dependencies
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" data-path="deployment/pred-intro.html">
            
                
                    <a href="../deployment/pred-intro.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        Turi Predictive Services
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="conclusion.html">
            
                
                    <a href="../conclusion.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        Conclusion
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="exercises.html">
            
                
                    <a href="../exercises.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        Exercises
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1" data-path="sframe/exercises.html">
            
                
                    <a href="../sframe/exercises.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.1.</b>
                        
                        Tabular data
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="sgraph/exercises.html">
            
                
                    <a href="../sgraph/exercises.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.</b>
                        
                        Graph data
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.3" data-path="graph_analytics/exercises.html">
            
                
                    <a href="../graph_analytics/exercises.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.3.</b>
                        
                        Graph analytics
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.4" data-path="supervised-learning/exercises.html">
            
                
                    <a href="../supervised-learning/exercises.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.4.</b>
                        
                        Classification
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.5" data-path="text/exercises.html">
            
                
                    <a href="../text/exercises.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.</b>
                        
                        Text analysis
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.6" data-path="recommender/exercises.html">
            
                
                    <a href="../recommender/exercises.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.</b>
                        
                        Recommender systems
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9" data-path="faq.html">
            
                
                    <a href="../faq.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        FAQ/Common Problems
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="10" data-path="contributing.html">
            
                
                    <a href="../contributing.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                        Contributing
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >Turi Machine Learning Platform User Guide</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <p><script src="../turi/js/recview.js"></script></p>
<h1 id="nearest-neighbors"><a name="nearest-neighbors" class="plugin-anchor" href="#nearest-neighbors"><span class="fa fa-link"></span></a>Nearest Neighbors</h1>
<p>The GraphLab Create
<a href="https://turi.com/products/create/docs/graphlab.toolkits.nearest_neighbors.html" target="_blank">nearest neighbors toolkit</a>
is used to find the rows in a data
table that are most similar to a query row. This is a two-stage process,
analogous to many other GraphLab Create toolkits. First we create a
<a href="https://turi.com/products/create/docs/generated/graphlab.nearest_neighbors.NearestNeighborsModel.html" target="_blank">NearestNeighborsModel</a>, using a
<strong>reference dataset</strong> contained in an
<a href="https://turi.com/products/create/docs/generated/graphlab.SFrame.html" target="_blank">SFrame</a>.
Next we query the model, using either the <code>query</code> or the <code>similarity_graph</code>
method. Each of these methods is explained further below.</p>
<p>For this chapter we use an example dataset of house attributes and prices,
downloaded from Turi&apos;s public datasets bucket.</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> graphlab <span class="hljs-keyword">as</span> gl
<span class="hljs-keyword">import</span> os

<span class="hljs-keyword">if</span> os.path.exists(<span class="hljs-string">&apos;houses.csv&apos;</span>):
    sf = gl.SFrame.read_csv(<span class="hljs-string">&apos;houses.csv&apos;</span>)
<span class="hljs-keyword">else</span>:
    data_url = <span class="hljs-string">&apos;https://static.turi.com/datasets/regression/houses.csv&apos;</span>
    sf = gl.SFrame.read_csv(data_url)
    sf.save(<span class="hljs-string">&apos;houses.csv&apos;</span>)

sf.head(<span class="hljs-number">5</span>)
</code></pre>
<pre><code class="lang-no-highlight">+------+---------+------+--------+------+-------+
| tax  | bedroom | bath | price  | size |  lot  |
+------+---------+------+--------+------+-------+
| 590  |    2    | 1.0  | 50000  | 770  | 22100 |
| 1050 |    3    | 2.0  | 85000  | 1410 | 12000 |
|  20  |    3    | 1.0  | 22500  | 1060 |  3500 |
| 870  |    2    | 2.0  | 90000  | 1300 | 17500 |
| 1320 |    3    | 2.0  | 133000 | 1500 | 30000 |
+------+---------+------+--------+------+-------+
[5 rows x 6 columns]
</code></pre>
<p>Because the features in this dataset have very different scales (e.g. price is
in the hundreds of thousands while the number of bedrooms is in the single
digits), it is important to <strong>normalize the features</strong>. In this example we
standardize so that each feature is measured in terms of standard deviations
from the mean (see <a href="http://en.wikipedia.org/wiki/Normalization_%28statistics%29" target="_blank">Wikipedia for more
detail</a>). In
addition, both reference and query datasets may have a column with row labels,
but for this example we let the model default to using row indices as labels.</p>
<pre><code class="lang-python"><span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> sf.column_names():
    sf[c] = (sf[c] - sf[c].mean()) / sf[c].std()
</code></pre>
<p>First, we <strong>create a nearest neighbors model</strong>. We can list specific features to
use in our distance computations, or default to using all features in the
reference SFrame. In the model summary below the following code snippet, note
that there are three features, because our second command specifies three
numeric SFrame columns as features for the model. There are also three unpacked
features, because each feature is in its own column.</p>
<pre><code class="lang-python">model = gl.nearest_neighbors.create(sf)
model = gl.nearest_neighbors.create(sf, features=[<span class="hljs-string">&apos;bedroom&apos;</span>, <span class="hljs-string">&apos;bath&apos;</span>, <span class="hljs-string">&apos;size&apos;</span>])
model.summary()
</code></pre>
<pre><code class="lang-no-highlight">Class                         : NearestNeighborsModel

Attributes
----------
Distance                      : euclidean
Method                        : ball tree
Number of examples            : 15
Number of feature columns     : 3
Number of unpacked features   : 3
Total training time (seconds) : 0.0091

Ball Tree Attributes
--------------------
Tree depth                    : 1
Leaf size                     : 1000
</code></pre>
<p>To retrieve the five closest neighbors for <em>new</em> data points or a <em>subset</em> of
the original reference data, we <strong>query</strong> the model with the <code>query</code> method.
Query points must also be contained in an SFrame, and must have columns with the
same names as those used to construct the model (additional columns are allowed,
but ignored). The result of the <code>query</code> method is an SFrame with four columns:
query label, reference label, distance, and rank of the reference point among
the query point&apos;s nearest neighbors.</p>
<pre><code class="lang-python">knn = model.query(sf[:<span class="hljs-number">5</span>], k=<span class="hljs-number">5</span>)
knn.head()
</code></pre>
<pre><code class="lang-no-highlight">+-------------+-----------------+----------------+------+
| query_label | reference_label |    distance    | rank |
+-------------+-----------------+----------------+------+
|      0      |        0        |      0.0       |  1   |
|      0      |        5        | 0.100742954001 |  2   |
|      0      |        7        | 0.805943632008 |  3   |
|      0      |        10       | 1.82070683014  |  4   |
|      0      |        2        | 1.83900997922  |  5   |
|      1      |        1        |      0.0       |  1   |
|      1      |        8        | 0.181337317202 |  2   |
|      1      |        4        | 0.181337317202 |  3   |
|      1      |        11       | 0.322377452803 |  4   |
|      1      |        12       | 0.705200678007 |  5   |
+-------------+-----------------+----------------+------+
[10 rows x 4 columns]
</code></pre>
<p>In some cases the query dataset <em>is</em> the reference dataset. For this task of
constructing the <strong>similarity_graph</strong> on the reference data, the model&apos;s
<code>similarity_graph</code> can be used. For brute force models it can be almost twice as
fast, depending on the data sparsity and chosen distance function. By default,
the <code>similarity_graph</code> method returns an
<a href="https://turi.com/products/create/docs/generated/graphlab.SGraph.html" target="_blank">SGraph</a>
whose vertices are the rows of the reference dataset and whose edges indicate a
nearest neighbor match. Specifically, the destination vertex of an edge is a
nearest neighbor of the source vertex. <code>similarity_graph</code> can also return
results in the same form as the <code>query</code> method if so desired.</p>
<pre><code class="lang-python">sim_graph = model.similarity_graph(k=<span class="hljs-number">3</span>)
sim_graph.show(vlabel=<span class="hljs-string">&apos;id&apos;</span>, arrows=<span class="hljs-keyword">True</span>)
</code></pre>
<p><img src="images/boston_sim_graph.png" alt="boston_sim_graph"></p>
<h4 id="distance-functions"><a name="distance-functions" class="plugin-anchor" href="#distance-functions"><span class="fa fa-link"></span></a>Distance functions</h4>
<p>The most critical choice in computing nearest neighbors is the <strong>distance
function</strong> that measures the dissimilarity between any pair of observations.</p>
<p>For numeric data, the options are <code>euclidean</code>, <code>manhattan</code>, <code>cosine</code>, and <code>transformed_dot_product.</code> For data in dictionary format (i.e. sparse data), <code>jaccard</code> and <code>weighted_jaccard</code> are also options, in addition to the numeric distances. For string features, use <code>levenshtein</code> distance, or use the text analytics toolkit&apos;s <code>count_ngrams</code> feature to convert strings to dictionaries of words or character shingles, then use Jaccard or weighted Jaccard distance. Leaving the distance parameter set to its default value of <code>auto</code> tells the model to choose the most reasonable distance based on the type of features in the reference data. In the following output cell, the second line of the model summary confirms our choice of Manhattan distance.</p>
<pre><code class="lang-python">model = gl.nearest_neighbors.create(sf, features=[<span class="hljs-string">&apos;bedroom&apos;</span>, <span class="hljs-string">&apos;bath&apos;</span>, <span class="hljs-string">&apos;size&apos;</span>],
                                    distance=<span class="hljs-string">&apos;manhattan&apos;</span>)
model.summary()
</code></pre>
<pre><code class="lang-no-highlight">Class                         : NearestNeighborsModel

Attributes
----------
Distance                      : manhattan
Method                        : ball tree
Number of examples            : 15
Number of feature columns     : 3
Number of unpacked features   : 3
Total training time (seconds) : 0.013

Ball Tree Attributes
--------------------
Tree depth                    : 1
Leaf size                     : 1000
</code></pre>
<p>Distance functions are also exposed in the <code>graphlab.distances</code> module. This
allows us not only to specify the distance argument for a nearest neighbors
model as a distance function (rather than a string), but also to <em>use</em> that
function for any other purpose.</p>
<p>In the following snippet we use a nearest neighbors model to find the closest
reference points to the first three rows of our dataset, then confirm the
results by computing a couple of the distances manually with the Manhattan
distance function.</p>
<pre><code class="lang-python">model = gl.nearest_neighbors.create(sf, features=[<span class="hljs-string">&apos;bedroom&apos;</span>, <span class="hljs-string">&apos;bath&apos;</span>, <span class="hljs-string">&apos;size&apos;</span>],
                                    distance=gl.distances.manhattan)
knn = model.query(sf[:<span class="hljs-number">3</span>], k=<span class="hljs-number">3</span>)
knn.print_rows()

sf_check = sf[[<span class="hljs-string">&apos;bedroom&apos;</span>, <span class="hljs-string">&apos;bath&apos;</span>, <span class="hljs-string">&apos;size&apos;</span>]]
<span class="hljs-keyword">print</span> <span class="hljs-string">&quot;distance check 1:&quot;</span>, gl.distances.manhattan(sf_check[<span class="hljs-number">2</span>], sf_check[<span class="hljs-number">10</span>])
<span class="hljs-keyword">print</span> <span class="hljs-string">&quot;distance check 2:&quot;</span>, gl.distances.manhattan(sf_check[<span class="hljs-number">2</span>], sf_check[<span class="hljs-number">14</span>])
</code></pre>
<pre><code class="lang-no-highlight">+-------------+-----------------+-----------------+------+
| query_label | reference_label |     distance    | rank |
+-------------+-----------------+-----------------+------+
|      0      |        0        |       0.0       |  1   |
|      0      |        5        |  0.100742954001 |  2   |
|      0      |        7        |  0.805943632008 |  3   |
|      1      |        1        |       0.0       |  1   |
|      1      |        8        |  0.181337317202 |  2   |
|      1      |        4        |  0.181337317202 |  3   |
|      2      |        2        |       0.0       |  1   |
|      2      |        10       | 0.0604457724006 |  2   |
|      2      |        14       |  1.61656820464  |  3   |
+-------------+-----------------+-----------------+------+
[9 rows x 4 columns

distance check 1: 0.0604457724006
distance check 2: 1.61656820464
</code></pre>
<p>GraphLab Create also allows <strong>composite distances</strong>, which allow the nearest neighbors tool (and other distance-based tools) to work with features that have different types. Specifically, a composite distance is a <em>weighted sum of standard distances applied to subsets of features</em>, specified in the form of a Python list. Each element of a composite distance list contains three things:</p>
<ol>
<li>a list or tuple of feature names</li>
<li>a standard distance name</li>
<li>a multiplier for the standard distance.</li>
</ol>
<p>In our house price dataset, for example, suppose we want to measure the difference between numbers of bedrooms and baths with Manhattan distance and the difference between house and lot sizes with Euclidean distance. In addition, we want the Euclidean component to carry twice as much weight. The composite distance for this would be:</p>
<pre><code class="lang-python">my_dist = [[[<span class="hljs-string">&apos;bedroom&apos;</span>, <span class="hljs-string">&apos;bath&apos;</span>], <span class="hljs-string">&apos;manhattan&apos;</span>, <span class="hljs-number">1</span>],
           [[<span class="hljs-string">&apos;size&apos;</span>, <span class="hljs-string">&apos;lot&apos;</span>], <span class="hljs-string">&apos;euclidean&apos;</span>, <span class="hljs-number">2</span>]]
</code></pre>
<p>This list can be passed to the <code>distance</code> parameter just like a standard
distance function name or handle.</p>
<pre><code class="lang-python">model = gl.nearest_neighbors.create(sf, distance=my_dist)
model.summary()
</code></pre>
<pre><code class="lang-no-highlight">Class                         : NearestNeighborsModel

Attributes
----------
Method                        : brute_force
Number of distance components : 2
Number of examples            : 15
Number of feature columns     : 4
Number of unpacked features   : 4
Total training time (seconds) : 0.0017
</code></pre>
<p>If we specify the distance parameter as <code>auto</code>, a composite distance is
created where each type of feature is paired with the most appropriate distance
function. Please see the documentation for the <a href="https://turi.com/products/create/docs/graphlab.toolkits.distances.html" target="_blank">GraphLab Create distances module</a> for more on composite distances.</p>
<h4 id="search-methods"><a name="search-methods" class="plugin-anchor" href="#search-methods"><span class="fa fa-link"></span></a>Search methods</h4>
<p>Another important choice in model creation is the <strong>method</strong>. The
<code>brute_force</code> method computes the distance between a query point and <em>each</em> of
the reference points, with a run time linear in the number of reference points.
Creating a model with the <code>ball_tree</code> method takes more time, but leads to
much faster queries by partitioning the reference data into successively smaller
balls and searching only those that are relatively close to the query.  The
default method is <code>auto</code> which chooses a reasonable method based on both the
feature types and the selected distance function. The method parameter is also
specified when the model is created. The third row of the model summary confirms
our choice to use the ball tree in the next example.</p>
<pre><code class="lang-python">model = gl.nearest_neighbors.create(sf, features=[<span class="hljs-string">&apos;bedroom&apos;</span>, <span class="hljs-string">&apos;bath&apos;</span>, <span class="hljs-string">&apos;size&apos;</span>],
                                    method=<span class="hljs-string">&apos;ball_tree&apos;</span>, leaf_size=<span class="hljs-number">5</span>)
model.summary()
</code></pre>
<pre><code class="lang-no-highlight">Class                         : NearestNeighborsModel

Attributes
----------
Method                        : ball_tree
Number of distance components : 1
Number of examples            : 15
Number of feature columns     : 3
Number of unpacked features   : 3
Total training time (seconds) : 0.0253

Ball Tree Attributes
--------------------
Tree depth                    : 3
Leaf size                     : 5
</code></pre>
<p>If the ball tree is used, it&apos;s important to choose an appropriate value for the
&apos;leaf_size&apos; parameter, which controls how many observations are stored in each
leaf of the ball tree. By default, this is set so that the tree is no more than
12 levels deep, but larger or smaller values may lead to quicker queries
depending on the shape and dimension of the data. Our houses example only has 15
rows, so the <code>leaf_size</code> parameter (and the <code>ball_tree</code> method for that
matter) are not too useful, but for illustration purposes we set the leaf size
to 5 above.</p>
<h4 id="missing-data"><a name="missing-data" class="plugin-anchor" href="#missing-data"><span class="fa fa-link"></span></a>Missing data</h4>
<p>The reference dataset that is used to create the nearest neighbors model cannot
have missing data. Please use the <a href="https://turi.com/products/cre
ate/docs/generated/graphlab.SFrame.fillna.html#graphlab.SFrame.fillna" target="_blank">SFrame.fillna</a> and
<a href="https://turi.com/products/create/docs/generated/graphlab.SFrame
.dro pna.html#graphlab.SFrame.dropna" target="_blank">SFrame.dropna</a> utilities to preprocess missing values
before creating a nearest neighbors model.</p>
<p>On the other hand, data passed to the <code>query</code> method <em>can</em> have missing data.
For numeric columns, missing values are imputed to be the mean of the
corresponding column in the reference dataset used to create the model. Missing
values in string columns are imputed as empty strings.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../clustering/dbscan.html" class="navigation navigation-prev " aria-label="Previous page: DBSCAN"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../text/intro.html" class="navigation navigation-next " aria-label="Next page: Text analysis"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-collapsible-menu/plugin.js"></script>
    

    
    <script src="https://cdn.mathjax.org/mathjax/2.5-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":"white","family":"sans","size":2},"customtheme":{"css":["turi/css/glc.css"],"js":["turi/js/d3/d3.min.js","turi/js/jquery/jquery-2.1.3.min.js","supervised-learning/images/random-utils.js","supervised-learning/images/plotting-utils.js","turi/js/metrics.js"]},"collapsible-menu":{},"anchors":{},"mathjax":{},"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
