[MUSIC] Now, we can use the model. Use image retrieval model with deep features to find similar images. So here we go. We're gonna take that model and
use it to find similar images. So let me go ahead and do exactly that. So first, remember,
let's take a particular image. So let's take and we'll call this cat,
you'll see the cat image. So out of my image training data. I'm gonna take the 18th image. So this is I'm gonna take
the 18th images like this. And just so that you know what it is, I'm gonna do cat['image'].show
to actually show that image. And so to show it in the notebook here, I'm gonna set the canvas target
to be the IPython Notebook. So all the things we've been doing so far. So, here we are. Here's an image of a cat and it's a tabby. For those images of the cats it looks,
appears a little small but it's an image of a cat. You can play with it. So now we can find the nearest
neighbors to this cat. So, lets go ahead and do that like that. Now, let's take this image of a cat and
just find it's nearest neighbors. So what I can do is take my knn_model and query it for the image of the cat. And so after a query,
you'll see that for this image of cat, the nearest images are image 384,
6910, and so on. And it's a little hard to get
those images from the numbers. So when we create that,
we'll create a helper function together that takes those indices and
actually shows you those images, so we are gonna actually take
the opportunity to define a function. So, I'm gonna define a new
python function and it's gonna say get_images_ids. So in this reference column here has ids,
this one here. And then we're gonna get the images back. So let's give it as the output here is going to be the Sorry. The output here is going
to be result of the query. So let's call it query_result. And it's a function, so all we're gonna do with the query_result
is return image_train. So I'm gonna take that training data and
I'm gonna do an operation called filter_by, which
just selects a set of rows of that data. And I'm gonna select it by
the query_result that we just created. And once I've done that and
select by query_result, backs to you a column, and the column
here is the reference_label column. Query_result['reference_label'] and what we're gonna do is say
return all images in the stable whose id matches this reference_label
column over here, this column. So that's what this helper function is. So I don't have to type it all the time. We can go ahead and use it but I am gonna do a little bit
of experimentation with it. So, let's just define this function. So, we've now defined it. Get images from ids. Actually, that's make more sense, right? So let's call it, get_images_from_ids. And so, let's go ahead and do it. So remember, for the cat, we had an image of our cat,
so let's just say, get, let's call it cat_neighbors. And so the cat_neighbors are gonna be, let's call this function
get_images_from_ids and as input, I'm going to take my knn_model
and query it with the cat as an input. Okay, so this is the cat neighbors. The images neighbors and now what I
can do is just show those images. So, cat_neighbors[' image'].show. So we had to play a little bit for
data to see, but this was the nearest cat, this is the input cat over here and you
can see the nearest cats are all cats and they are all kind of like tabbies. [MUSIC]