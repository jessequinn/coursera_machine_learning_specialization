[음악] 우선 문서를 어떻게 표현하는지 설명드리겠습니다 아마 문서 표현에 가장 인기있는 방법은 bag-of-words(단어주머니) 모델인데 문서에서 단어 순서를 무시하는 방식입니다 bag-of-words 모델이라 불리는 이유는 주머니에다 문서의 모든 단어를 쓸어넣고 뒤섞은 다음 새로운 문서를 만들어도 원 문서에서 순서대로 정리된 단어와 정확히 같은 표현이 되기 때문이죠 다음으로 단어 순서 같은 구조를 고려하기보다 문서에 등장하는 모든 단어의 등장 빈도를 셉니다 구체적인 예를 한번 들어보죠 이 문서에서 문장 하나만 있다고 가정하고 문장은 Carlos calls the sport futbol,
Emily calls the sport soccer입니다 실제로는 두 문장 같지만 아무튼 이게 문서 전체입니다 이제 이 짧은 문서에서 단어 빈도를 세서 벡터로 만듭니다 벡터는 대상 언어의 사전으로 정의됩니다 사전에서 단어 하나는 이름인 Carlos일지도 모르죠 벡터에는 sport란 단어의 인덱스도 어딘가 있을 겁니다 And then, somewhere else we have the word
futbol luckily in our English vocabulary
운좋게도 futbol이란 단어가 영어 사전에 있고 Emily가 마지막 항목이라고 하죠 어떤 단어가 빠졌죠? calls와 the가 빠졌죠 Carlos가 몇 개 있죠? 하나밖에 없죠 the가 몇 개 있죠? the는 두 개 있죠 calls 두 개, sport 두 개 futbol 하나, 그리고 soccer를 잊었는데 하나죠 Emily 하나, 여기서 soccer를 넣고 이게 인덱스라 가정하면 단어수 벡터는 이런 모습이겠죠 문서에서 다른 모든 항목은 0이 됩니다 다른 항목은 고양이, 개, 나무처럼 사전에는 있지만 문서에 등장하지 않는 단어를 나타냅니다 등장하는 단어수를 세는 아주아주 커다란 희소벡터입니다 단어수만으로 문서를 표현하는 방법을 알아봤습니다 bag-of-words 모델입니다 여러 문서 사이의 유사도를 측정하는 법을 알아볼 텐데 문서가 서로 얼마나 연관되어 있나 알기 위해 필요하기 때문입니다 카를로스가 기사를 읽는데 그가 관심을 가질만한
기사가 어떤 게 있을까요? 이게 축구와 유명 아르헨티나 선수 메시에 대한 기사의 카운트 벡터라고 할게요 파란색을 칠한 또 다른 기사와 그에 딸린 단어수입니다 이 기사는 또 다른 유명 축구선수 펠레에 관한 것입니다 발음이 맞나요? >> 펠레
>> 펠레 [웃음] 유사도를 측정할 때 벡터의 스칼라곱을 계산합니다 벡터의 모든 항에 대해 두 단어수 벡터 각각의 항을 곱합니다 그리고 전체를 더합니다 이렇게 계산하면 1 곱하기 3, 다른 항들은 곱하면 0이 되고 5번째 항에 5 곱하기 2가 있습니다 벡터 전체에 곱셈을 하면 모든 항의 합은 13이 됩니다 축구 기사 둘 사이의 유사도를 측정해봤습니다 이제 다른 기사와 비교할 건데 아프리카의 분쟁이 주제입니다 이 기사에 등장하는 단어수를 예를 들어볼게요 이 기사 간의 유사도 측정법인 스칼라곱으로 곱하고 더하면 유사도는 이 경우 0이 됩니다 단어수로 문서 간의 유사도를 측정할 때 나타나는 문제를 알아보죠 그러기 위해 초록, 파란 기사를 다시 봅니다 단어수 벡터와 계산으로 돌아가보면 똑같이 축구가 주제인 두 기사 간의 유사도는 13으로 나옵니다 그러면 문서 길이를 두 배로 늘릴 때 어떻게 되나 보죠 원 문서에서 등장하는 모든 단어는 새 문서에서 빈도가 두 배가 됩니다 단어수 벡터는 간단히 원래 벡터의 2배가 되죠 이렇게 유사도를 다시 계산하면 유사도는 이제 52로 나옵니다 생각해봅시다 두 문서의 관계는 이전과 동일합니다 같은 스포츠가 주제인데 길이가 두 배라고 더 유사하답니다 카를로스가 긴 문서에 관심 있다고 결론 내릴 수 있겠네요 카를로스가 짧은 문서를 읽고 있었다면 어떻게 되나요 문서 검색에서 그다지 타당한 방법이 아닙니다 긴 문서에 심하게 편향되니까요 이걸 어떻게 극복할지 고민해봅시다 한 가지 방법은 아주 간단하게 벡터를 정규화하는 것이죠 단어수 벡터에서 노름(norm)을 계산해냅니다 벡터 노름 계산을 하려면 모든 항을 제곱해서 더한 다음 다시 제곱근을 씌우죠 이 경우 1 제곱 더하기 5 제곱 더하기 3 제곱 더하기 1 제곱에
제곱근을 씌웁니다 그러면 6이란 숫자가 나오는데 정규화된 단어수 벡터가 슬라이드 밑 부분에 나옵니다 모든 대상 기사에 대해 길이와 관계없이 동등한 위치를 부여하게 됩니다 그런 다음 정규화된 벡터로 검색을 하는 것이죠 [음악]